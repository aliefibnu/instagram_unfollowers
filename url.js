(()=>{const k="iwr",b=1e3,c=1e4,d=4e3;let l=[],h=!0,t=-1,p=0,f=0,s="i",w=JSON.parse(localStorage.getItem(k)||"[]"),u=[],n=0,z="fb";function g(n){let t=`; ${document.cookie}`,o=t.split(`; ${n}=`);return 2===o.length?o.pop().split(";").shift():null}function q(e){let t=g("ds_user_id");if(!t){s="e";b();return""}return`https://www.instagram.com/graphql/query/?query_hash=3dec7e2c57367ef3da3d987d89f9dbc8&variables={"id":"${t}","include_reel":"true","fetch_mutual":"false","first":"24"${e?`,"after":"${e}"`:""}}`}async function y(t){return new Promise(r=>setTimeout(r,t))}async function a(e=null){try{if(n>=5){await y(c);n=0}s="f";let t=q(e);if(!t)return;let o=await fetch(t);if(!o.ok){s="e";b();return}let j=await o.json(),r=j?.data?.user?.edge_follow;if(!r){s="e";b();return}t===-1&&(t=r.count);let i=r.edges.map(e=>({i:e.node.id,u:e.node.username,n:e.node.full_name,p:e.node.profile_pic_url,r:e.node.is_private,f:e.node.follows_viewer}));l.push(...i);f=l.length;p=Math.floor(f/t*100);h=r.page_info.has_next_page;let c=r.page_info.end_cursor;n++;await y(b);b();return{r:i,h,c}}catch(e){s="e";b()}}function v(){let e=z==="fb"?l.filter(e=>e.f):l.filter(e=>!e.f);return e.map(e=>`<div class=uc><img src=${e.p} alt=${e.u}><div class=ui><div class=un>${e.u}</div><p class=fn>${e.n||'No name'}</p><div class=st><span class=st ${e.r?'prv':'pub'}>${e.r?'Private':'Public'}</span></div><button class=ub data-uid=${e.i}>Unfollow</button></div></div>`)}function b(){let t='*{margin:0;padding:0;box-sizing:border-box;font-family:Arial,sans-serif}body{background:linear-gradient(135deg,#f9e1e8,#e6e6fa,#e0f7fa);padding:10px;color:#333}.c{max-width:480px;margin:0 auto}.ms{display:flex;gap:5px;justify-content:center;margin-bottom:10px}.mb{padding:8px 16px;border:none;border-radius:5px;background:linear-gradient(to right,#ff99cc,#cc99ff);color:#fff;font-weight:700}.mb.ac{background:linear-gradient(to right,#cc66aa,#9966cc)}.ps{background:rgba(255,255,255,.8);border-radius:10px;padding:10px;margin-bottom:10px}.pi{display:flex;justify-content:space-between;margin-bottom:5px;font-size:.9rem;font-weight:700;color:#555}.pb{width:100%;height:8px;background:#e0e0e0;border-radius:5px;overflow:hidden}.pbf{height:100%;background:linear-gradient(to right,#ff99cc,#cc99ff)}.ug{display:flex;flex-direction:column;gap:10px}.uc{background:rgba(255,255,255,.8);border-radius:10px;padding:10px;display:flex;align-items:center}.uc img{width:50px;height:50px;border-radius:50%;object-fit:cover;border:2px solid #ffd1dc;margin-right:10px}.ui{flex:1}.un{font-size:1rem;font-weight:700;color:#4a4a4a}.fn{font-size:.8rem;color:#666;margin:5px 0}.st{display:flex;gap:5px;margin-top:5px}.st{font-size:.7rem;padding:3px 6px;border-radius:10px}.prv{background:#e6ccff;color:#663399}.pub{background:#ccffcc;color:#339933}.sm{text-align:center;margin-top:10px;font-size:1rem;font-weight:500;color:#555}.ub{margin-top:5px;padding:6px 12px;border:none;border-radius:5px;background:linear-gradient(to right,#ff6666,#cc3333);color:#fff;font-weight:700}.ub:disabled{background:#ccc}',m=s==='f'?'Fetching...':s==='c'?'Done!':s==='e'?'Error':s==='u'?'Unfollowing...':'Ready';document.body.innerHTML=`<style>${t}</style><div class=c><div class=ms><button class=mb fbb ${z==='fb'?'ac':''} data-f=fb>Follows Back</button><button class=mb nfbb ${z==='nfb'?'ac':''} data-f=nfb>Not Following</button></div><div class=ps><div class=pi><span>Progress: <span id=p>${p}%</span></span><span>Fetched: <span id=t>${f} / ${t}</span></span></div><div class=pb><div id=pb class=pbf style=width:${p}%></div></div></div><div class=ug>${v().join('')}</div><div class=sm><p id=s>${m}</p></div></div>`;document.querySelectorAll('.mb').forEach(e=>e.addEventListener('click',()=>{z=e.getAttribute('data-f');b()}));document.querySelectorAll('.ub').forEach(e=>e.addEventListener('click',async()=>{let i=e.getAttribute('data-uid'),u=e.closest('.uc').querySelector('.un').textContent.trim();if(window.confirm(`Unfollow ${u}?`)){e.disabled=!0;s="u";b();try{await r(i);e.textContent='Unfollowed'}catch(_){e.textContent='Error'}s="c";b()}}))}async function r(i){try{let t=await fetch(`/web/friendships/${i}/unfollow/`,{method:'POST',headers:{'Content-Type':'application/x-www-form-urlencoded','X-CSRFToken':g('csrftoken'),'X-Requested-With':'XMLHttpRequest'}});if(!t.ok){s="e";b();return}let j=await t.json();if(j.status!=='ok'){s="e";b();return}l=l.filter(t=>t.i!==i);f=l.length;p=Math.floor(f/t*100);u.push(i);await y(d);b()}catch(e){s="e";b()}}async function x(){if(s!=='i')return;try{b();let e=null;while(h){let o=await a(e);if(!o){h=!1;break}let{r:_,h:hp,c:nc}=o;e=nc}s='c';b()}catch(e){s='e';b()}}window.b=b;x();})()